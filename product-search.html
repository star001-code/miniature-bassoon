<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<title>ğŸ“¦ Ø§Ù„Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø°ÙƒÙŠØ© Ù„Ù„Ø±Ø³Ù… ÙƒÙ…Ø±Ùƒ Ø§Ù„Ø¹Ø±Ø§Ù‚</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
  body{font-family:"Segoe UI","Noto Naskh Arabic",sans-serif;background:#0f172a;color:#e5e7eb;display:flex;justify-content:center;align-items:center;min-height:100vh;margin:0}
  .card{background:#111827;padding:20px;border-radius:14px;max-width:480px;width:100%;box-shadow:0 4px 10px rgba(0,0,0,0.4)}
  h1{text-align:center;color:#60a5fa;margin-top:0}
  label{display:block;margin:10px 0 4px}
  input{width:100%;padding:10px;border-radius:8px;border:1px solid #334155;background:#1e293b;color:#e5e7eb}
  button{width:100%;padding:12px;margin-top:12px;border:none;border-radius:8px;background:#2563eb;color:white;cursor:pointer;font-size:16px}
  button:hover{background:#3b82f6}
  .result{margin-top:12px;padding:12px;border-radius:10px;background:#0b1220}
  .ok{background:#064e3b;color:#d1fae5}
</style>
</head>
<body>
<div class="card">
  <h1>ğŸ“¦ Ø§Ù„Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø°ÙƒÙŠØ©<br>Ù„Ù„Ø±Ø³Ù… ÙƒÙ…Ø±Ùƒ Ø§Ù„Ø¹Ø±Ø§Ù‚</h1>

  <label>ğŸ” Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ IDE</label>
  <input id="q" placeholder="Ù…Ø«Ø§Ù„: Ø¹Ø¬ÙˆÙ„ / 1022910">

  <label>âš–ï¸ Ø§Ù„ÙˆØ²Ù† Ø§Ù„ÙƒÙ„ÙŠ (ÙƒØº)</label>
  <input id="w" type="number">

  <label>ğŸ’µ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ù…Ø¯ÙÙˆØ¹ Ø¨Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø®Ù„ÙŠÙ„ (USD)</label>
  <input id="paid" type="number">

  <label>ğŸ’° Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„ÙƒÙ„ÙŠØ© Ù„Ù„Ø­Ù…Ù„ (USD)</label>
  <input id="total" type="number">

  <label>ğŸ“Š Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯ (GDS_YER)</label>
  <input id="yer" type="number">

  <label>ğŸ”¢ Ø³Ø¹Ø± Ø§Ù„ØµØ±Ù (Ø¯ÙŠÙ†Ø§Ø±/Ø¯ÙˆÙ„Ø§Ø±)</label>
  <input id="ex" type="number" value="1320">

  <label>ğŸ·ï¸ Ø§Ù„Ù†Ø³Ø¨Ø© (%)</label>
  <input id="rt" type="number" value="6" step="0.01">

  <button onclick="calc()">Ø§Ø­Ø³Ø¨</button>
  <div id="out" class="result ok" style="display:none"></div>
</div>

<script>
let DB=[], current=null;
const $=s=>document.querySelector(s);
const fmt=x=>{const n=Number(x);return isFinite(n)?n.toLocaleString('ar-IQ',{maximumFractionDigits:3}):'-';};

function calc(){
  const w    = parseFloat($("#w").value)||0;
  const paid = parseFloat($("#paid").value)||0;
  const yer  = parseFloat($("#yer").value)||0;
  const ex   = parseFloat($("#ex").value)||1320;
  const rt   = parseFloat($("#rt").value)||6;

  if(!(w>0) || !(yer>0)){
    alert("âš ï¸ Ø£Ø¯Ø®Ù„ Ø§Ù„ÙˆØ²Ù† ÙˆÙ‚ÙŠÙ…Ø© Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯ (GDS_YER)");
    return;
  }

  // Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø© Ø­Ø³Ø¨ Ø§Ù„ÙˆØµÙ:
  // Ø§Ù„Ø±Ø³Ù… = (ÙˆØ²Ù† Ã— GDS_YER Ã— (Ø§Ù„Ù†Ø³Ø¨Ø© Ã· 100)) + (Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ù…Ø¯ÙÙˆØ¹) Ã— Ø³Ø¹Ø± Ø§Ù„ØµØ±Ù
  const A  = w * yer * (rt/100);
  const B  = paid;
  const AB = (A + B) * ex;   // Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ø¨Ø§Ù„Ø¯ÙŠÙ†Ø§Ø±

  const out=$("#out"); out.style.display="";
  out.innerHTML=`
    <div>ğŸ·ï¸ Ø§Ù„Ù…Ù†ØªØ¬: ${current?current.product:($("#q").value||"-")}</div>
    <div>ğŸ”¢ Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø±ÙŠØ­Ø© (IDE): ${current?(current.IDE||"-"):"-"}</div>
    <div>âš–ï¸ Ø§Ù„ÙˆØ²Ù† Ø§Ù„ÙƒÙ„ÙŠ: ${fmt(w)} ÙƒØº</div>
    <div>ğŸ’° Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯ (GDS_YER): ${fmt(yer)} USD/Ø·Ù†</div>
    <div>ğŸ·ï¸ Ø§Ù„Ù†Ø³Ø¨Ø©: ${rt}%</div>
    <div>ğŸ’µ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ù…Ø¯ÙÙˆØ¹ Ø¨Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø®Ù„ÙŠÙ„: ${fmt(B)} USD</div>
    <div><b>âœ…ğŸ’³ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ${fmt(AB)} Ø¯ÙŠÙ†Ø§Ø±</b></div>
  `;
}

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ø¥Ø°Ø§ Ø¹Ù†Ø¯Ùƒ products.json)
(async()=>{
  try{
    const res=await fetch("products.json");
    DB=await res.json();
  }catch(e){}
  const p=new URLSearchParams(location.search);
  const q=p.get("name")||p.get("ide");
  if(q){
    $("#q").value=q;
    current=DB.find(r=>r.product==q || r.IDE==q) || null;
    if(current && current.GDS_YER) $("#yer").value=current.GDS_YER;
  }
})();
</script>
</body>
</html>
